"use strict";(self.webpackChunkpoi_plugin_quest_info_2=self.webpackChunkpoi_plugin_quest_info_2||[]).push([[871],{"./src/components/QuestTag.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{M:()=>QuestTag});var _blueprintjs_core__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@blueprintjs/core/lib/esm/components/index.js"),_blueprintjs_icons__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@blueprintjs/icons/lib/esm/iconNames.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),styled_components__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),_questHelper__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/questHelper.ts"),_store_filterTags__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/store/filterTags.ts"),_store_quest__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/store/quest.ts"),_store_search__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/store/search.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/react/jsx-runtime.js");const TagWrapper=(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.ZP)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_7__.Vp)`
  margin: 2px 4px;
  user-select: ${_ref=>{let{interactive}=_ref;return interactive?"none":"auto"}};
  overflow: visible;

  & > span {
    cursor: ${_ref2=>{let{interactive}=_ref2;return interactive?"pointer":"auto"}};
  }
`,QuestTooltip=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(((_ref3,ref)=>{let{quest,children,...props}=_ref3;return quest?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_blueprintjs_core__WEBPACK_IMPORTED_MODULE_7__.u,{ref,content:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{children:`${quest.code} - ${quest.name}`}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{children:quest.desc}),quest.memo2&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("b",{children:quest.memo2})}),quest.rewards&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("i",{children:quest.rewards})})]}),placement:"top",...props,children}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment,{children})})),QuestTag=_ref4=>{let{code}=_ref4;const{setSearchInput}=(0,_store_search__WEBPACK_IMPORTED_MODULE_4__.d)(),{setCategoryTagsAll,setTypeTagsAll}=(0,_store_filterTags__WEBPACK_IMPORTED_MODULE_2__.E8)(),maybeQuest=(0,_store_quest__WEBPACK_IMPORTED_MODULE_3__.Sg)(code),maybeGameId=maybeQuest?.gameId??null,tagIcon=(questStatus=>{switch(questStatus){case _questHelper__WEBPACK_IMPORTED_MODULE_1__.pf.ALREADY_COMPLETED:return _blueprintjs_icons__WEBPACK_IMPORTED_MODULE_8__.d.TICK;case _questHelper__WEBPACK_IMPORTED_MODULE_1__.pf.LOCKED:return _blueprintjs_icons__WEBPACK_IMPORTED_MODULE_8__.d.LOCK;default:return null}})((0,_store_quest__WEBPACK_IMPORTED_MODULE_3__.dM)(maybeGameId)),handleClick=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((()=>{setSearchInput(code),setCategoryTagsAll(),setTypeTagsAll()}),[code,setCategoryTagsAll,setSearchInput,setTypeTagsAll]),indicatorColor=(0,_questHelper__WEBPACK_IMPORTED_MODULE_1__.oY)(code).color,fontColor="#fff"===indicatorColor||"#87da61"===indicatorColor?"black":"white";if(!maybeQuest)return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(TagWrapper,{icon:_blueprintjs_icons__WEBPACK_IMPORTED_MODULE_8__.d.HELP,style:{color:fontColor,background:indicatorColor},children:code});const quest=maybeQuest.docQuest;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(QuestTooltip,{quest,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(TagWrapper,{interactive:!0,icon:tagIcon,onClick:handleClick,style:{color:fontColor,background:indicatorColor},children:code})})};QuestTag.displayName="QuestTag";try{QuestTag.displayName="QuestTag",QuestTag.__docgenInfo={description:"",displayName:"QuestTag",props:{code:{defaultValue:null,description:"",name:"code",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/QuestTag.tsx#QuestTag"]={docgenInfo:QuestTag.__docgenInfo,name:"QuestTag",path:"src/components/QuestTag.tsx#QuestTag"})}catch(__react_docgen_typescript_loader_error){}},"./src/store/filterTags.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E8:()=>useFilterTags,Sz:()=>useFilterProgressTag,Up:()=>useSyncGameTagEffect});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_use__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react-use/esm/useUpdateEffect.js"),_poi_hooks__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/poi/hooks.ts"),_poi_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/poi/types.ts"),_store__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/store/store.tsx");const useFilterTags=()=>{const{store:{categoryTags,typeTags},updateStore}=(0,_store__WEBPACK_IMPORTED_MODULE_3__.oR)(),setCategoryTags=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((tagName=>{updateStore({categoryTags:{[tagName]:!0}})}),[updateStore]),setCategoryTagsAll=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((()=>{setCategoryTags(_store__WEBPACK_IMPORTED_MODULE_3__.RU.name)}),[setCategoryTags]),setTypeTags=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((tagName=>{updateStore({typeTags:{[tagName]:!0}})}),[updateStore]),setMultiTypeTags=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((data=>{updateStore({typeTags:data})}),[updateStore]),setTypeTagsAll=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((()=>{setTypeTags(_store__WEBPACK_IMPORTED_MODULE_3__.MU.name)}),[setTypeTags]);return{categoryTags,typeTags,setCategoryTags,setCategoryTagsAll,setTypeTags,setMultiTypeTags,setTypeTagsAll}},useFilterProgressTag=()=>{const{store:{progressTag},updateStore}=(0,_store__WEBPACK_IMPORTED_MODULE_3__.oR)(),toggleTag=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((tag=>{updateStore(progressTag!==tag?{progressTag:tag}:{progressTag:_store__WEBPACK_IMPORTED_MODULE_3__.UP.All})}),[progressTag,updateStore]);return{progressTag,toggleTag}},useSyncGameTagEffect=()=>{const{progressTag}=useFilterProgressTag(),filterTags=useFilterTags(),tab=(0,_poi_hooks__WEBPACK_IMPORTED_MODULE_1__.s_)();(0,react_use__WEBPACK_IMPORTED_MODULE_4__.Z)((()=>{if(progressTag===_store__WEBPACK_IMPORTED_MODULE_3__.UP.Unlocked)switch(tab){case _poi_types__WEBPACK_IMPORTED_MODULE_2__.V.ALL:filterTags.setTypeTagsAll();break;case _poi_types__WEBPACK_IMPORTED_MODULE_2__.V.DAILY:filterTags.setTypeTags("Daily");break;case _poi_types__WEBPACK_IMPORTED_MODULE_2__.V.WEEKLY:filterTags.setTypeTags("Weekly");break;case _poi_types__WEBPACK_IMPORTED_MODULE_2__.V.MONTHLY:filterTags.setTypeTags("Monthly");break;case _poi_types__WEBPACK_IMPORTED_MODULE_2__.V.IN_PROGRESS:filterTags.setTypeTags("In Progress");break;case _poi_types__WEBPACK_IMPORTED_MODULE_2__.V.OTHERS:filterTags.setMultiTypeTags({Quarterly:!0,Yearly:!0});break;case _poi_types__WEBPACK_IMPORTED_MODULE_2__.V.ONCE:filterTags.setTypeTags("One-time")}}),[tab])}},"./src/store/search.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{R:()=>useStableSearchWords,d:()=>useSearchInput});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_store__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/store/store.tsx");const useSearchInput=()=>{const{store:{searchInput},updateStore}=(0,_store__WEBPACK_IMPORTED_MODULE_1__.oR)();return{searchInput,setSearchInput:(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((value=>updateStore({searchInput:value})),[updateStore])}},useStableSearchWords=()=>{const{searchInput}=useSearchInput();return function(value){let limit=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;const[throttledValue,setThrottledValue]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(value),lastRan=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(Date.now());return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{const handler=setTimeout((function(){Date.now()-lastRan.current>=limit&&(setThrottledValue(value),lastRan.current=Date.now())}),limit-(Date.now()-lastRan.current));return()=>{clearTimeout(handler)}}),[value,limit]),throttledValue}(searchInput).split(" ").filter((i=>!!i)).map((i=>i.toUpperCase()))}},"./src/stories/QuestTag.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Main:()=>Main,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var styled_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),_components_QuestTag__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/QuestTag.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");const __WEBPACK_DEFAULT_EXPORT__={title:"QuestTag",component:_components_QuestTag__WEBPACK_IMPORTED_MODULE_1__.M,argTypes:{}},Spacing=styled_components__WEBPACK_IMPORTED_MODULE_3__.ZP.div`
  * + * {
    margin-top: 8px;
  }
`,Template=args=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(Spacing,{children:args.list.map((tag=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_components_QuestTag__WEBPACK_IMPORTED_MODULE_1__.M,{...tag},tag.code)))});Template.displayName="Template";const Main=Template;Main.args={list:[{code:"A1"},{code:"A2"},{code:"B1"},{code:"B2"},{code:"A0"}]};const __namedExportsOrder=["Main"]}}]);
//# sourceMappingURL=stories-QuestTag-stories.bad80077.iframe.bundle.js.map