{"version":3,"file":"stories-QuestTag-stories.bad80077.iframe.bundle.js","mappings":";;AAYA;;;;AAIA;;AAIA;;;;ACHA","sources":["webpack://poi-plugin-quest-info-2/./src/components/QuestTag.tsx","webpack://poi-plugin-quest-info-2/./src/stories/QuestTag.stories.tsx"],"sourcesContent":["import type { TooltipProps } from '@blueprintjs/core'\nimport { Tag, Tooltip } from '@blueprintjs/core'\nimport { IconNames } from '@blueprintjs/icons'\nimport React, { forwardRef, useCallback } from 'react'\nimport styled from 'styled-components'\nimport { DocQuest, QUEST_STATUS, guessQuestCategory } from '../questHelper'\nimport { useFilterTags } from '../store/filterTags'\nimport { useQuestByCode, useQuestStatus } from '../store/quest'\nimport { useSearchInput } from '../store/search'\n\nconst TagWrapper = styled(Tag)`\n  margin: 2px 4px;\n  user-select: ${({ interactive }) => (interactive ? 'none' : 'auto')};\n  overflow: visible;\n\n  & > span {\n    cursor: ${({ interactive }) => (interactive ? 'pointer' : 'auto')};\n  }\n`\n\nconst QuestTooltip = forwardRef<\n  Tooltip,\n  Omit<TooltipProps, 'content'> & {\n    quest: DocQuest\n    children: React.ReactNode\n  }\n>(({ quest, children, ...props }, ref) => {\n  if (!quest) {\n    return <>{children}</>\n  }\n  return (\n    <Tooltip\n      ref={ref}\n      content={\n        <>\n          <div>{`${quest.code} - ${quest.name}`}</div>\n          <div>{quest.desc}</div>\n          {quest.memo2 && (\n            <div>\n              <b>{quest.memo2}</b>\n            </div>\n          )}\n          {quest.rewards && (\n            <div>\n              <i>{quest.rewards}</i>\n            </div>\n          )}\n        </>\n      }\n      placement={'top'}\n      {...props}\n    >\n      {children}\n    </Tooltip>\n  )\n})\n\nconst getTagIcon = (questStatus: QUEST_STATUS) => {\n  switch (questStatus) {\n    case QUEST_STATUS.ALREADY_COMPLETED:\n      return IconNames.TICK\n    case QUEST_STATUS.LOCKED:\n      return IconNames.LOCK\n    default:\n      return null\n  }\n}\n\nexport const QuestTag = ({ code }: { code: string }) => {\n  const { setSearchInput } = useSearchInput()\n  const { setCategoryTagsAll, setTypeTagsAll } = useFilterTags()\n  const maybeQuest = useQuestByCode(code)\n  const maybeGameId = maybeQuest?.gameId ?? null\n  const questStatus = useQuestStatus(maybeGameId)\n  const tagIcon = getTagIcon(questStatus)\n\n  const handleClick = useCallback(() => {\n    setSearchInput(code)\n    setCategoryTagsAll()\n    setTypeTagsAll()\n  }, [code, setCategoryTagsAll, setSearchInput, setTypeTagsAll])\n  const indicatorColor = guessQuestCategory(code).color\n  const fontColor =\n    indicatorColor === '#fff' || indicatorColor === '#87da61'\n      ? 'black'\n      : 'white'\n\n  if (!maybeQuest) {\n    return (\n      <TagWrapper\n        icon={IconNames.HELP}\n        style={{ color: fontColor, background: indicatorColor }}\n      >\n        {code}\n      </TagWrapper>\n    )\n  }\n\n  const quest = maybeQuest.docQuest\n  return (\n    <QuestTooltip quest={quest}>\n      <TagWrapper\n        interactive\n        icon={tagIcon}\n        onClick={handleClick}\n        style={{ color: fontColor, background: indicatorColor }}\n      >\n        {code}\n      </TagWrapper>\n    </QuestTooltip>\n  )\n}\n","import type { Meta, Story } from '@storybook/react'\nimport React from 'react'\nimport styled from 'styled-components'\nimport { QuestTag } from '../components/QuestTag'\n\nexport default {\n  title: 'QuestTag',\n  component: QuestTag,\n  argTypes: {},\n} as Meta\n\nconst Spacing = styled.div`\n  * + * {\n    margin-top: 8px;\n  }\n`\n\nconst Template: Story<{ list: Parameters<typeof QuestTag>[0][] }> = (args) => (\n  <Spacing>\n    {args.list.map((tag) => (\n      <QuestTag key={tag.code} {...tag} />\n    ))}\n  </Spacing>\n)\n\nexport const Main = Template\nMain.args = {\n  list: [\n    {\n      code: 'A1',\n    },\n    {\n      code: 'A2',\n    },\n    {\n      code: 'B1',\n    },\n    {\n      code: 'B2',\n    },\n    {\n      code: 'A0', // Unknown quest\n    },\n  ],\n}\n"],"names":[],"sourceRoot":""}