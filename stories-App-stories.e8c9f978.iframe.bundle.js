"use strict";(self.webpackChunkpoi_plugin_quest_info_2=self.webpackChunkpoi_plugin_quest_info_2||[]).push([[412],{"./src/stories/App.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Primary:()=>Primary,__namedExportsOrder:()=>__namedExportsOrder,default:()=>App_stories});var react=__webpack_require__("./node_modules/react/index.js"),components=__webpack_require__("./node_modules/@blueprintjs/core/lib/esm/components/index.js"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),iconNames=__webpack_require__("./node_modules/@blueprintjs/icons/lib/esm/iconNames.js"),hooks=__webpack_require__("./src/poi/hooks.ts"),questHelper=__webpack_require__("./src/questHelper.ts"),store=__webpack_require__("./src/store/index.ts"),filterTags=__webpack_require__("./src/store/filterTags.ts"),gameQuest=__webpack_require__("./src/store/gameQuest.tsx"),search=__webpack_require__("./src/store/search.ts"),types=__webpack_require__("./src/poi/types.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const withDocQuest=filterFn=>unionQuest=>filterFn(unionQuest.docQuest),CATEGORY_TAGS=[store.RU,{name:"Composition",filter:withDocQuest(questHelper.aj)},{name:"Sortie",filter:withDocQuest(questHelper.u$)},{name:"Exercise",filter:withDocQuest(questHelper.fN)},{name:"Expedition",filter:withDocQuest(questHelper.HN)},{name:"Supply / Docking",filter:withDocQuest(questHelper.m2)},{name:"Arsenal",filter:withDocQuest(questHelper.QU)},{name:"Modernization",filter:withDocQuest(questHelper.Ed)},{name:"Others",filter:withDocQuest(questHelper.r0)}],TYPE_TAGS=[store.MU,{name:"In Progress",filter:(filterFn=questHelper.I4,fallback=!1,_ref=>{let{gameQuest}=_ref;return gameQuest?filterFn(gameQuest):fallback})},{name:"New",filter:questHelper.ff},{name:"Daily",filter:questHelper.AS},{name:"Weekly",filter:questHelper.g1},{name:"Monthly",filter:questHelper.Wj},{name:"One-time",filter:questHelper.Xx},{name:"Quarterly",filter:questHelper.U9},{name:"Yearly",filter:questHelper.FV}];var filterFn,fallback;const TagsWrapper=styled_components_browser_esm.ZP.div`
  display: flex;
  flex-wrap: wrap;
  margin-left: -4px;
  margin-right: -4px;

  & > * {
    margin: 4px;
  }
`,ProgressTags=()=>{const{t}=(0,hooks.a5)(),{progressTag,toggleTag}=(0,filterTags.Sz)(),{lockedQuestNum,unlockedQuestNum,completedQuestNum,alreadyCompletedQuestNum}=(0,gameQuest.vF)(),completedQuestSuffix=completedQuestNum>0?`${alreadyCompletedQuestNum} + ${completedQuestNum}`:alreadyCompletedQuestNum;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(components.Vp,{onClick:()=>{toggleTag(store.UP.Locked)},intent:progressTag===store.UP.Locked?"success":"none",interactive:!0,children:t("Locked",{number:lockedQuestNum})}),(0,jsx_runtime.jsx)(components.Vp,{icon:iconNames.d.EXCHANGE,onClick:()=>{toggleTag(store.UP.Unlocked)},intent:progressTag===store.UP.Unlocked?"success":"none",interactive:!0,children:t("Unlocked",{number:unlockedQuestNum})}),(0,jsx_runtime.jsx)(components.Vp,{onClick:()=>{toggleTag(store.UP.AlreadyCompleted)},intent:progressTag===store.UP.AlreadyCompleted?"success":"none",interactive:!0,children:t("Already Completed",{number:completedQuestSuffix})})]})},CategoryTags=()=>{const{t}=(0,hooks.a5)(),{categoryTags,setCategoryTags}=(0,filterTags.E8)();return(0,jsx_runtime.jsxs)(TagsWrapper,{children:[CATEGORY_TAGS.map((_ref2=>{let{name}=_ref2;return(0,jsx_runtime.jsx)(components.Vp,{onClick:()=>setCategoryTags(name),intent:categoryTags[name]?name===store.RU.name?"success":"primary":"none",interactive:!0,children:t(name)},name)})),(0,jsx_runtime.jsx)(ProgressTags,{})]})};CategoryTags.displayName="CategoryTags";const TypeTags=()=>{const{t}=(0,hooks.a5)(),gameTab=(0,hooks.s_)(),{syncWithGame}=(0,store.bJ)(),gameQuests=(0,gameQuest.d5)(),{progressTag}=(0,filterTags.Sz)(),inProgressQuest=gameQuests.filter((gameQuest=>(0,questHelper.I4)(gameQuest))),{typeTags,setTypeTags}=(0,filterTags.E8)(),limitSwitch=syncWithGame&&gameTab!==types.V.ALL;return(0,jsx_runtime.jsxs)(TagsWrapper,{children:[(0,jsx_runtime.jsx)(components.Vp,{intent:typeTags.All?"success":"none",interactive:!0,onClick:()=>setTypeTags("All"),children:t("All")}),(0,jsx_runtime.jsx)(components.Vp,{intent:typeTags["In Progress"]?progressTag===store.UP.AlreadyCompleted||progressTag===store.UP.Locked?"warning":"primary":"none",interactive:!0,onClick:()=>setTypeTags("In Progress"),children:t("In Progress",{number:inProgressQuest.length})}),questHelper.lg&&(0,jsx_runtime.jsx)(components.Vp,{intent:typeTags.New?"primary":"none",interactive:!0,onClick:()=>setTypeTags("New"),children:t("New",{number:questHelper.Rs})}),TYPE_TAGS.slice(3).map((tag=>(0,jsx_runtime.jsx)(components.Vp,{onClick:()=>setTypeTags(tag.name),intent:typeTags[tag.name]?limitSwitch?"warning":"primary":"none",interactive:!0,children:t(tag.name)},tag.name)))]})};TypeTags.displayName="TypeTags";var utils=__webpack_require__("./src/utils.ts");const ToolbarWrapper=styled_components_browser_esm.ZP.div`
  display: flex;
  flex-direction: column;
  padding: 4px 8px;

  & > * + * {
    margin-top: 8px;
  }
`,SearchInput=()=>{const{t}=(0,hooks.a5)(),{searchInput,setSearchInput}=(0,search.d)(),handleChange=(0,react.useCallback)((event=>setSearchInput(event.target.value)),[setSearchInput]),handleClear=(0,react.useCallback)((()=>setSearchInput("")),[setSearchInput]);return(0,jsx_runtime.jsx)(components.BZ,{value:searchInput,onChange:handleChange,placeholder:t("Search"),leftIcon:iconNames.d.SEARCH,rightElement:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:!!searchInput&&(0,jsx_runtime.jsx)(components.zx,{icon:iconNames.d.CROSS,onClick:handleClear})}),type:"text"})};SearchInput.displayName="SearchInput";const Toolbar=()=>((0,filterTags.Up)(),(0,jsx_runtime.jsxs)(ToolbarWrapper,{children:[(0,jsx_runtime.jsx)(SearchInput,{}),(0,jsx_runtime.jsx)(CategoryTags,{}),(0,jsx_runtime.jsx)(TypeTags,{})]}));Toolbar.displayName="Toolbar";const useToolbarFilter=()=>{const searchFilter=(()=>{const searchKeywords=(0,search.R)();return(0,react.useCallback)((quest=>{if(!searchKeywords||!searchKeywords.length)return!0;const text=`${quest.docQuest.code} ${quest.docQuest.name} ${quest.docQuest.desc} ${quest.docQuest.rewards??""} ${quest.docQuest.memo2??""}`;return searchKeywords.some((keyword=>text.toUpperCase().includes(keyword)))}),[searchKeywords])})(),{typeTags,categoryTags}=(0,filterTags.E8)(),{progressTag}=(0,filterTags.Sz)(),questStatusQuery=(0,gameQuest.XF)(),progressTagFilter=(0,react.useCallback)((quest=>{const questStatus=questStatusQuery(quest.gameId);switch(progressTag){case store.UP.All:return!0;case store.UP.Locked:return questStatus===questHelper.pf.LOCKED||questStatus===questHelper.pf.UNKNOWN;case store.UP.Unlocked:return questStatus===questHelper.pf.DEFAULT||questStatus===questHelper.pf.IN_PROGRESS||questStatus===questHelper.pf.COMPLETED;case store.UP.AlreadyCompleted:return questStatus===questHelper.pf.COMPLETED||questStatus===questHelper.pf.ALREADY_COMPLETED;default:console.warn("Unknown progressTag type!",progressTag)}return!0}),[progressTag,questStatusQuery]),typeTagsFilter=(0,utils.Or)(...TYPE_TAGS.filter((tag=>typeTags[tag.name])).map((tag=>tag.filter))),categoryTagsFilter=(0,utils.Or)(...CATEGORY_TAGS.filter((tag=>categoryTags[tag.name])).map((tag=>tag.filter)));return(0,utils.W8)(searchFilter,typeTagsFilter,categoryTagsFilter,progressTagFilter)};try{SearchInput.displayName="SearchInput",SearchInput.__docgenInfo={description:"",displayName:"SearchInput",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/Toolbar.tsx#SearchInput"]={docgenInfo:SearchInput.__docgenInfo,name:"SearchInput",path:"src/Toolbar.tsx#SearchInput"})}catch(__react_docgen_typescript_loader_error){}var index_esm=__webpack_require__("./node_modules/react-virtualized-auto-sizer/dist/index.esm.js"),dist_index_esm=__webpack_require__("./node_modules/react-window/dist/index.esm.js"),QuestCard=__webpack_require__("./src/components/QuestCard/index.tsx");const QuestListWrapper=styled_components_browser_esm.ZP.div`
  flex: 1;
  overflow: hidden;
`,ListWrapper=(0,styled_components_browser_esm.ZP)(dist_index_esm.S_)`
  -webkit-overflow-scrolling: auto;

  ::-webkit-scrollbar {
    -webkit-appearance: none;
    width: 8px;
  }

  ::-webkit-scrollbar-thumb {
    border-radius: 4px;
    background-color: rgba(1, 1, 1, 0.3);
  }

  ::-webkit-scrollbar {
    border-radius: 4px;
    background-color: rgba(1, 1, 1, 0.1);
  }
`,QuestList=_ref=>{let{quests}=_ref;const activeTab=(0,hooks.Li)(),listRef=(0,react.useRef)(null),rowHeights=(0,react.useRef)({});(0,react.useEffect)((()=>{listRef.current?.resetAfterIndex(0)}),[quests]),(0,react.useEffect)((()=>{activeTab&&listRef.current?.resetAfterIndex(0)}),[activeTab]);const setRowHeight=(0,react.useCallback)(((index,size)=>{rowHeights.current[index]!==size&&(rowHeights.current={...rowHeights.current,[index]:size},listRef.current?.resetAfterIndex(index))}),[]),getRowHeight=(0,react.useCallback)((index=>rowHeights.current[index]+8||200),[]),Row=_ref2=>{let{index,style}=_ref2;const rowRef=(0,react.useRef)(null),quest=quests[index],{gameId}=quest,{code,name,desc,rewards,memo2}=quest.docQuest;return(0,react.useEffect)((()=>{rowRef.current&&setRowHeight(index,rowRef.current.clientHeight)}),[index]),(0,jsx_runtime.jsx)("div",{style,children:(0,jsx_runtime.jsx)("div",{ref:rowRef,children:(0,jsx_runtime.jsx)(QuestCard.X,{style:{margin:"4px"},gameId,code,name,desc,tip:rewards,tip2:memo2})})})};return(0,jsx_runtime.jsx)(QuestListWrapper,{children:(0,jsx_runtime.jsx)(index_esm.Z,{children:_ref3=>{let{height,width}=_ref3;return(0,jsx_runtime.jsx)(ListWrapper,{ref:listRef,height,width,itemCount:quests.length,estimatedItemSize:200,itemSize:getRowHeight,children:Row})}})})};QuestList.displayName="QuestList";try{QuestList.displayName="QuestList",QuestList.__docgenInfo={description:"",displayName:"QuestList",props:{quests:{defaultValue:null,description:"",name:"quests",required:!0,type:{name:"UnionQuest[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/QuestList.tsx#QuestList"]={docgenInfo:QuestList.__docgenInfo,name:"QuestList",path:"src/components/QuestList.tsx#QuestList"})}catch(__react_docgen_typescript_loader_error){}const Container=styled_components_browser_esm.ZP.div`
  display: flex;
  flex: 1;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  user-select: text;

  & > * + * {
    margin-top: 8px;
  }
`,CountText=(0,styled_components_browser_esm.ZP)(components.xv)`
  margin: 0 8px;
`,Main=()=>{const{t}=(0,hooks.a5)(),quests=(()=>{const toolbarFilter=useToolbarFilter();return(0,store.B4)().filter(toolbarFilter)})();return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Toolbar,{}),(0,jsx_runtime.jsx)(CountText,{children:t("TotalQuests",{number:quests.length})}),(0,jsx_runtime.jsx)(QuestList,{quests})]})},App=()=>(0,jsx_runtime.jsx)(react.StrictMode,{children:(0,jsx_runtime.jsx)(store.g3,{children:(0,jsx_runtime.jsx)(Container,{children:(0,jsx_runtime.jsx)(Main,{})})})});App.displayName="App";const App_stories={title:"App",component:App,argTypes:{}},Template=()=>(0,jsx_runtime.jsx)(App,{});Template.displayName="Template";const Primary=Template.bind({}),__namedExportsOrder=["Primary"]}}]);
//# sourceMappingURL=stories-App-stories.e8c9f978.iframe.bundle.js.map